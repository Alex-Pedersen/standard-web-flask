{% extends "base.html" %}


{% block title %}Forums - Standard Survival Minecraft Server{% endblock %}

{% block select_forum %}selected{% endblock %}

{% block content %}
    <div id="main">
        <h2>Standard Survival Forums</h2>
        {% for category in categories %}
            <div class="forum-category">
                <h4>{{ category.name }}</h4>
                <table class="forum-table">
                    {% for forum in category.forums %}
                        <tr>
                            <td class="forum-cell">
                                <img class="acitivity-icon" src="{{ url_for('static', filename='images/forums/active_topic.png') }}">
                                <div class="forum-info">
                                    <a class="name" href="">{{ forum.name }}</a>
                                    <div class="description">
                                        {{ forum.description }}
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="count">
                                    <b>{{ forum.topic_count }}</b> topics
                                </div>
                                <div class="count">
                                    <b>{{ forum.post_count }}</b> posts
                                </div>

                            </td>
                            <td class="last-post-cell">
                                {% with last_post = forum.last_post %}
                                {% with last_topic = last_post.topic %}
                                {% with last_post_user = last_post.user %}
                                <div>
                                    <b>Topic:</b> <a href="{{ last_topic.url }}">{{ last_topic.name | truncate(30) }}</a>
                                </div>
                                <div>
                                    <b>Last post:</b> <a href="{{ last_post.url }}"><abbr class="timeago" title="{{ last_post.created | iso_date }}">{{ last_post.created }}</abbr></a>
                                </div>
                                <div>
                                    <b>By:</b> <a href="{{ url_for('player', username=last_post_user.username) }}">{{ last_post_user.username }}</a>
                                </div>
                                {% endwith %}
                                {% endwith %}
                                {% endwith %}
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% endfor %}
    </div>
{% endblock %}
